define(["jquery"],function(e){window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(k){window.setTimeout(k,42)}}());var g,j;g={};j={};g.debug=false;j.topics={"*":e.Callbacks("unique memory")};g.publish=function b(l){var k;k=[].slice.call(arguments);k.unshift(window);g.publishWith.apply(this,k)};g.publishWith=function a(n,q){var m,l,o,k,p;p=Array.prototype.slice.call(arguments);p.shift();p.shift();q=j.parse_topics(q);l=q.length;for(m=0;m<l;m++){o=q[m].split(".");while(o.length){k=o.join(".");o.pop();if(!j.topics[k]){j.topics[k]=e.Callbacks("unique memory")}j.publish(n,k,q[m],p)}j.publish(n,"*",q[m],p)}};g.subscribe=function c(o,k){var n,m,l;if(!e.isFunction(k)){console.error("You must subscribe with a function",[o,k])}o=j.parse_topics(o);m=o.length;for(n=0;n<m;n++){l=o[n];if(!j.topics[l]){j.topics[l]=e.Callbacks("unique memory")}j.topics[l].add(k)}};g.unsubscribe=function h(o,k){var n,m,l;if(!e.isFunction(k)){console.error("You must unsubscribe with a function")}o=j.parse_topics(o);m=o.length;for(n=0;n<m;n++){l=o[n];if(j.topics[l]){j.topics[l].remove(k)}}};g.clear=function f(k){j.topics[k]=e.Callbacks("unique memory")};g.purge=function d(){var k;for(k in j.topics){if(j.topics.hasOwnProperty(k)){g.clear(k)}}};j.parse_topics=function i(k){return k.split(" ")};j.publish=function b(m,l,k,n){n=n.slice();if(j.topics[l]&&k){n.unshift(k);window.requestAnimFrame(function(){j.topics[l].fireWith(m,n)})}};g.subscribe("*",function(l){var k;if(!window.console){return}if(!g.debug){return}k=Array.prototype.slice.call(arguments,1);if(console.group){console.group("PubSub Super Listner");console.debug("Topic: ",l);console.debug("Arguments: ",k);console.groupEnd("PubSub Super Listner")}else{console.log("PubSub Super Listner: ",l,k)}});if(window.__karma__){g._=j}e.pubsub=g});