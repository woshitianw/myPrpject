G.Layer.AMap=G.Layer.Tile.extend({init:function(t,e){var i,a=this,e=e||{},r={cluster:["01","02","03","04"],minRes:.59716429,filter:e.filter?e.filter:""},t=t||"street";"street"==t?i="http://webrd{s}.is.autonavi.com/appmaptile?size=1&scale=1&style="+(e.style?e.style:"7")+"&x={x}&y={y}&z={z}":"street2"==t?i="http://webst{s}.is.autonavi.com/appmaptile?style=7&x={x}&y={y}&z={z}":"sate"==t?i="http://webst{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}":"satel"==t?i="http://webst{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}":"traffic"==t&&(i=function(t,i,a){return"http://tm.mapabc.com/trafficengine/mapabc/traffictile?v="+(e.v?e.v:"1.0")+"&zoom="+(17-t)+"&x="+i+"&y="+a}),"satel"!=t&&"traffic"!=t||(r.keepResample=!1),G.Layer.Tile.prototype.init.call(a,i,r)}}),G.Layer.AliMap=G.Layer.Tile.extend({init:function(){G.Layer.Tile.prototype.init.call(this,"http://img.ditu.aliyun.com/get_png?x={x}&y={y}&z={z}",{crossOrigin:""})}}),G.Layer.BaiduMap=G.Layer.Tile.extend({init:function(t,e){var i=this,e=e||{},a={originX:-33554432,originY:33554432,cluster:["0","1","2","3","4","5","6","7","8","9"],zoomReses:[262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1,.5],minRes:.5,maxRes:32768},t=t||"street",r=function(i,a,r,l){var s=Math.ceil(Math.pow(2,i-1)),n=i,o=a-s,c=s-r-1;return"street"==t?"http://online{s}.map.bdimg.com/tile/?qt=tile&x="+o+"&y="+c+"&z="+n+"&scaler="+l+"&styles=pl":"satel"==t?"http://online{s}.map.bdimg.com/tile/?qt=tile&x="+o+"&y="+c+"&z="+n+"&styles=sl":"sate"==t?"http://shangetu{s}.map.bdimg.com/it/u=x="+(o<0?"M":"")+Math.abs(o)+";y="+(c<0?"M":"")+Math.abs(c)+";z="+n+";v="+(e.v?e.v:"009")+";type="+t+"&fm="+(e.fm?e.fm:"46"):"traffic"==t?"http://its.map.baidu.com:8002/traffic/TrafficTileService?x="+o+"&y="+c+"&level="+n+"&v="+(e.v?e.v:"033")+"&label="+(e.label?e.label:"web2D")+"&time="+ +new Date:void 0};"satel"!=t&&"traffic"!=t||(a.keepResample=!1),G.Layer.Tile.prototype.init.call(i,r,a)}}),G.Layer.BingMap=G.Layer.Tile.extend({init:function(t,e){var i=this,e=e||{},a={crossOrigin:"",cluster:[0,1,2,3],filter:e.filter?e.filter:""},t=t||"street",r=function(i,a,r){var l,s="";for(l=i;l>0;l--){var n="0",o=1<<l-1;0!=(a&o)&&n++,0!=(r&o)&&(n++,n++),s+=n}return"street"==t?"http://t{s}.tiles.ditu.live.com/tiles/r"+s+".png?g="+(e.g?e.g:"2785"):"traffic"==t?"http://t{s}.tiles.ditu.live.com/tiles/dp/content?p=tf&a="+s+"&tc="+ +new Date:void 0};"traffic"==t&&(a.keepResample=!1),a.minRes=.59716429,G.Layer.Tile.prototype.init.call(i,r,a)}}),G.Layer.CartoMap=G.Layer.Tile.extend({init:function(t){var e={cluster:["a","b","c","d"]},t=t||"midnight",i="http://cartocdn_{s}.global.ssl.fastly.net/base-"+t+"/{z}/{x}/{y}.png";G.Layer.Tile.prototype.init.call(this,i,e)}}),G.Layer.GoogleCnMap=G.Layer.Tile.extend({init:function(t,e){var i,a=this,e=e||{},r={cluster:["0","1","2","3"],filter:e.filter?e.filter:""},t=t||"street",l=e.traffic?",traffic":"",s=G.Browser.retina?2:1;"street"==t?i="http://mt{s}.google.cn/vt/lyrs=m"+l+"&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&scale="+s:"terrian"==t?i="http://mt{s}.google.cn/vt/lyrs=t,r"+l+"&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&scale="+s:"sate"==t?i="http://mt{s}.google.cn/vt/lyrs=s"+l+"&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&scale="+s:"satel"==t&&(i="http://mt{s}.google.cn/vt/lyrs=s,h"+l+"&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}&scale="+s),G.Layer.Tile.prototype.init.call(a,i,r)}}),G.Layer.NasaMap=G.Layer.Tile.extend({init:function(t,e,i,a,r){var t=t||"MODIS_Terra_CorrectedReflectance_TrueColor",e=e||"2014-04-09",a=a||"250m",r="jpeg"==r?"jpg":r||"jpg",l=9;"250m"==a?l=9:"500m"==a?l=8:"1km"==a?l=7:"2km"==a&&(l=6);var s,n;4326==i?(s="EPSG4326_"+a,n=.002197265625*Math.pow(2,9-l)):3857==i&&(s="GoogleMapsCompatible_Level"+l,n=305.7481131407048*Math.pow(2,9-l));var o,c={};4326==i?(o="wmts-geo",c={srid:4326,originX:-180,originY:90,minX:-179.999,maxX:179.999,minY:-89.999,maxY:89.999,tileSize:512,cluster:["1","2"],zoomReses:[.5625,.28125,.140625,.0703125,.03525625,.017628125,.0087890624,.00439453125,.002197265625],minRes:n,maxRes:.5625}):3857==i&&(o="wmts-webmerc",c={srid:3857,cluster:["1","2"],minRes:n,maxRes:156543.03390625});var p="http://map{s}.vis.earthdata.nasa.gov/"+o+"/"+t+"/default/"+e+"/"+s+"/{z}/{y}/{x}."+r;G.Layer.Tile.prototype.init.call(this,p,c)}}),G.Layer.OpenStreetMap=G.Layer.Tile.extend({init:function(t){var t=t||{};G.Layer.Tile.prototype.init.call(this,"http://{s}.tile.osm.org/{z}/{x}/{y}.png",{cluster:["a","b","c"],filter:t.filter?t.filter:""})}}),G.Layer.QQMap=G.Layer.Tile.extend({init:function(t,e){var i=this,e=e||{},a={cluster:["0","1","2","3"],maxRes:78271.516964,minRes:.59716429,filter:e.filter?e.filter:""},t=t||"street",r=function(e,i,a){var r=e,l=i,s=Math.pow(2,e)-a-1,n=Math.floor(l/16),o=Math.floor(s/16);return"street"==t?(s=Math.pow(2,e+1)-a-1,o=Math.floor(s/16),"http://p{s}.map.gtimg.com/hwaptiles/"+r+"/"+n+"/"+o+"/"+l+"_"+s+".png"):"sate"==t?"http://p{s}.map.gtimg.com/sateTiles/"+r+"/"+n+"/"+o+"/"+l+"_"+s+".jpg":"satel"==t?"http://p{s}.map.gtimg.com/sateTranTilesv3/"+r+"/"+n+"/"+o+"/"+l+"_"+s+".png":void 0};"street"==t&&(a.tileSize=128),"satel"==t&&(a.keepResample=!1),G.Layer.Tile.prototype.init.call(i,r,a)}}),G.Layer.TiandituMap=G.Layer.Tile.extend({init:function(t,e){var i,a=this,r={srid:4326,originX:-180,originY:90,minX:-180,maxX:180,minY:-90,maxY:90,cluster:["0","1","2","3","4","5","6","7"],zoomReses:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765629e-19,429153442382814e-19,214576721191407e-19,107288360595703e-19,536441802978515e-20],minRes:536441802978515e-20,maxRes:.3515625},t=t||"street";"street"==t?i="http://t{s}.tianditu.com/DataServer?T=vec_c&x={x}&y={y}&l={z}":"streetl"==t?i="http://t{s}.tianditu.com/DataServer?T=cva_c&x={x}&y={y}&l={z}":"sate"==t?i="http://t{s}.tianditu.cn/img_c/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=c&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles":"satel"==t?i="http://t{s}.tianditu.cn/cia_c/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=c&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles":"terrain"==t?i="http://t{s}.tianditu.cn/ter_c/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=ter&tileMatrixSet=c&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles":"terrainl"==t&&(i="http://t{s}.tianditu.cn/cta_c/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cta&tileMatrixSet=c&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles"),"streetl"!=t&&"satel"!=t&&"terrainl"!=t||(r.keepResample=!1),"terrain"!=t&&"terrainl"!=t||(r.minRes=858306884765629e-19),G.Layer.Tile.prototype.init.call(a,i,r)}}),G.Proj.Baidu={baiduFactor:3e3*Math.PI/180,llBand:[75,60,45,30,15,0],mcBand:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],mc2ll:[[1.410526172116255e-8,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,17337981.2],[-7.435856389565537e-9,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552e-8,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437e-9,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878e-9,8983055095805407e-21,-3.068298e-8,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],ll2mc:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],project:function(t,e){var i=G.Proj.Gcj.project(t,e),a=i[0],r=i[1],l=G.Proj.Baidu.baiduFactor,s=Math.sqrt(a*a+r*r)+2e-5*Math.sin(r*l),n=Math.atan2(r,a)+3e-6*Math.cos(a*l),o=s*Math.cos(n)+.0065,c=s*Math.sin(n)+.006;return[o,c]},unproject:function(t,e){var i=G.Proj.Baidu.baiduFactor,a=t-.0065,r=e-.006,l=Math.sqrt(a*a+r*r)-2e-5*Math.sin(r*i),s=Math.atan2(r,a)-3e-6*Math.cos(a*i),n=l*Math.cos(s),o=l*Math.sin(s);return G.Proj.Gcj.unproject(n,o)},projectM:function(t,e){var i,a,r,l=G.Proj.Baidu,s=l.project(t,e);for(a=0,r=l.llBand.length;a<r;a++)if(s[1]>=l.llBand[a]){i=l.ll2mc[a];break}if(!i)for(a=llBand.length-1;a>=0;a--)if(s[1]<=-l.llBand[a]){i=l.ll2mc[a];break}var n=l._convert(s[0],s[1],i);return n},unprojectM:function(t,e){var i,a,r,l=G.Proj.Baidu,s=Math.abs,n=s(t),o=s(e);for(a=0,r=l.mcBand.length;a<r;a++)if(o>=l.mcBand[a]){i=l.mc2ll[a];break}var c=l._convert(n,o,i),p=l.unproject(c[0],c[1]);return p},_convert:function(t,e,i){var a=Math.abs,r=i[0]+i[1]*a(t),l=a(e)/i[9],s=i[2]+i[3]*l+i[4]*l*l+i[5]*l*l*l+i[6]*l*l*l*l+i[7]*l*l*l*l*l+i[8]*l*l*l*l*l*l;return r*=t<0?-1:1,s*=e<0?-1:1,[r,s]}};